<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="js/TweenMax.min.js"></script>
	<style>
		.drag{
			position: relative;
			border: solid 1px;
			height: 200px;
			width:400px;
		}
		.dot{
			width: 40px;
			height: 40px;
			background: red;
			border-radius:50%;
			position: absolute;
		}
		.dot1{			
			bottom: 60px;
			right: 100px;
		}
		.dot2{			
			bottom: 0px;
			left: 100px;
		}
	</style>
</head>
<body>

<!-- <rect id="rect" x="20" y="10" width="100" height="100" fill="red">
		<animate
			attributeName="width"
			begin="0s"
			dur="5s"
			from="20"
			to="500"
			fill="freeze"
		/>
		
	</rect>
	<circle id="circle" cx="170" cy="50" r="50" fill="blue"/>
	<animate
			attributeName="cx"
			xlink:href="#circle"
			begin="0s"
			dur="5s"
			from="170"
			to="450"
			fill="freeze"
		/>
	<animateColor
			attributeName="fill"
			xlink:href="#circle"
			begin="0s"
			dur="5s"
			values="blue; orange; yellow"
		/>
	
	<line id="line" x1="230" y1="10" x2="300" y2="100" style="stroke:green;stroke-width:2" />
	<polygon points="350,10,300,100,400,100" fill="grey" /> -->
	<div class="drag">
		<div class="dot dot0"></div>
		<div class="dot dot1"></div>
		<div class="dot dot2"></div>
		<svg id ="svg" height="200" width="400" xmlns="http://www.w3.org/2000/svg">
			<path d="" stroke="#e1f6f1" fill="none" stroke-width="10"/>
		</svg>
	</div>
	<script>
		var auxArray = [];
		var auxCor = [{x:27,y:29},{x:291,y:129},{x:128,y:187}];
		var svg = document.getElementById('svg');
		var bandera1 = true;
		$(document).ready(function(){
			$(".dot").on('mousedown',function(e){
				e.preventDefault();
				length = auxArray.length;//(auxArray.length == 0)?1:auxArray.length;
				
				//console.log($(this).hasClass('dot'+length));

				var x1 = e.clientX,
					y1 = e.clientY;

				//console.log(x1,y1);
				if($(this).hasClass('dot'+length)){
					$('.drag').on('mousemove',function(e){
						length = auxArray.length;
						var x2 = e.clientX,
							y2 = e.clientY;

						switch(length){
							case 0:
								svg.children[length].setAttribute('d','M'+ x1+','+y1+'L'+x2+','+y2);
								//console.log((x2-20),(y2-20));
								if((x2 >= (auxCor[(length+1)].x-10)  && x2 <= (auxCor[(length+1)].x+10)) && 
									(y2 >= (auxCor[(length+1)].y-10) && y2 <= (auxCor[(length+1)].y+10)) && bandera1==true) {
									bandera1 = false;
									auxArray.push(length);
									addPath('path',{d:'M'+auxCor[(length+1)].x+','+auxCor[(length+1)].y+'L'+x2+','+y2,stroke:'#e1f6f1',fill:'none','stroke-width':10});
									//svg.children[auxArray.length].setAttribute('d','M'+ x1+','+y1+'L'+x2+','+y2);
								}
							break;
							case 1:
								svg.children[length].setAttribute('d','M'+ auxCor[length].x+','+auxCor[length].y+'L'+x2+','+y2);
								//console.log((x2-20),(y2-20));
								if((x2 >= (auxCor[(length+1)].x-10)  && x2 <= (auxCor[(length+1)].x+10)) && 
									(y2 >= (auxCor[(length+1)].y-10) && y2 <= (auxCor[(length+1)].y+10)) && bandera1==true) {
									bandera1 = false;
									auxArray.push(length);
									addPath('path',{d:'M'+auxCor[(length+1)].x+','+auxCor[(length+1)].y+'L'+x2+','+y2,stroke:'#e1f6f1',fill:'none','stroke-width':10});
									//svg.children[auxArray.length].setAttribute('d','M'+ x1+','+y1+'L'+x2+','+y2);
								}
							break;
						}
						
						//console.log(x2,y2);						
						//var path = document.getElementById('svg');
						
					});
					$('.drag,.dot').on('mouseup',function(e){
						$('.drag').off('mousemove');
					});
				}
			});
		});

		//addPath('path',{d:'M290,126,L134,189',stroke:'#e1f6f1',fill:'none','stroke-width':10})
		function addPath(tag,attrs){
			var newpath = document.createElementNS("http://www.w3.org/2000/svg",tag);
			for (var k in attrs)
                newpath.setAttributeNS(null,k, attrs[k]);

			svg.appendChild(newpath);
		}
		
	</script>
</body>
</html>